import{r as p,j as b,B as v,h as T}from"./vendor-BuXgCdhF.js";const P=new T.Howl({src:["/wheel-of-names/sounds/spin.wav"],preload:!0}),L=new T.Howl({src:["/wheel-of-names/sounds/win.wav"],preload:!0}),B=({names:a,setNames:D,onShuffle:k,onSelectWinner:y})=>{const A=p.useRef(null),[I,S]=p.useState(0),[j,R]=p.useState(!1),[c,$]=p.useState({removeAfterWin:!0,darkMode:!1}),r=p.useRef(null),X=(e,t)=>{const n=a.length,s=2*Math.PI/n,i=t/2-5,h=3,l=30;e.clearRect(0,0,t,t),e.save(),e.beginPath(),e.arc(t/2,t/2,i+h,0,2*Math.PI),e.fillStyle=c.darkMode?"#222":"#ddd",e.fill(),e.translate(t/2,t/2),e.rotate(I),a.forEach((f,g)=>{const d=g*s,u=d+s;e.beginPath(),e.moveTo(0,0),e.arc(0,0,i,d,u),e.fillStyle=`hsl(${g*360/n}, 80%, ${c.darkMode?"60%":"75%"})`,e.fill(),e.beginPath(),e.moveTo(0,0),e.arc(0,0,i,d,u),e.strokeStyle=c.darkMode?"rgba(0,0,0,0.3)":"rgba(255,255,255,0.5)",e.lineWidth=1,e.stroke(),e.save(),e.rotate(d+s/2),e.translate(i/2+10,0),e.rotate(Math.PI/2),e.rotate(Math.PI/2);const w=window.innerWidth>768?Math.min(24,240/Math.max(5,n)):Math.min(16,200/Math.max(5,n));e.font=`${w}px Arial, sans-serif`,e.fillStyle=c.darkMode?"white":"black",e.textAlign="center";let m=f;const M=window.innerWidth>768?17:8;f.length>M&&(m=f.slice(0,M)+"..."),e.fillText(m,0,0),e.restore()}),e.restore(),e.beginPath(),e.arc(t/2,t/2,l,0,2*Math.PI);const o=e.createRadialGradient(t/2-5,t/2-5,0,t/2,t/2,l);c.darkMode?(o.addColorStop(0,"#444"),o.addColorStop(1,"#222")):(o.addColorStop(0,"#fff"),o.addColorStop(1,"#f0f0f0")),e.fillStyle=o,e.fill(),e.strokeStyle=c.darkMode?"#555":"#ddd",e.lineWidth=2,e.stroke(),e.beginPath(),e.fillStyle="#e74c3c",e.moveTo(t/2-10,10),e.lineTo(t/2+10,10),e.lineTo(t/2,30),e.closePath(),e.fill(),e.strokeStyle=c.darkMode?"#222":"#fff",e.lineWidth=1,e.stroke()};p.useEffect(()=>{const e=A.current;if(!e)return;const t=e.getContext("2d");if(!t)return;const n=e.offsetWidth,s=window.devicePixelRatio||1;e.width=n*s,e.height=n*s,t.scale(s,s),t.clearRect(0,0,e.width,e.height),X(t,n)},[a,I,c.darkMode]),p.useEffect(()=>(r.current=setInterval(()=>{S(e=>e+.01)},50),()=>{r.current&&clearInterval(r.current)}),[]);const W=()=>{if(L.stop(),j||a.length<2)return;r.current&&(clearInterval(r.current),r.current=null),k&&k(),R(!0),P.play();const e=5500,t=2*Math.PI/a.length,n=Math.random()*2*Math.PI,s=Math.random()*t,i=n+12*Math.PI+s,h=performance.now(),l=o=>{const f=o-h,g=Math.min(f/e,1),d=1-Math.pow(1-g,3),u=n+(i-n)*d;if(S(u),g<1)requestAnimationFrame(l);else{R(!1),setTimeout(()=>P.stop(),200),L.play();const w=(u%(2*Math.PI)+2*Math.PI)%(2*Math.PI),m=(w+Math.PI/2)%(2*Math.PI),M=a.length-1-Math.floor(m/t)%a.length,C=a[M];console.log(`Winner: ${C} (index: ${M})`),y&&y(C),S(w),r.current&&(clearInterval(r.current),r.current=null),P.stop()}};requestAnimationFrame(l)},Y=e=>{r.current&&(clearInterval(r.current),r.current=null);const t=I,n="touches"in e?e.touches[0].clientX:e.clientX,s="touches"in e?e.touches[0].clientY:e.clientY;let i=!1;const h=o=>{const f="touches"in o?o.touches[0].clientX:o.clientX,g="touches"in o?o.touches[0].clientY:o.clientY,d=f-n,u=g-s;Math.sqrt(d**2+u**2)>20&&(i=!0);const m=t+Math.atan2(u,d);S(m)},l=()=>{document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",l),document.removeEventListener("touchmove",h),document.removeEventListener("touchend",l),i&&W()};document.addEventListener("mousemove",h),document.addEventListener("mouseup",l),document.addEventListener("touchmove",h),document.addEventListener("touchend",l)},E=e=>{window.innerWidth<=768?W():Y(e)};return b.jsx(v,{textAlign:"center",bg:"transparent",color:"black",display:"flex",flexDirection:{base:"column",md:"row"},alignItems:"center",justifyContent:"center",children:b.jsx(v,{position:"relative",width:{base:"100%",md:"50%"},height:{base:"300px",md:"600px"},display:"flex",justifyContent:"center",alignItems:"center",cursor:{base:"pointer",md:"grab"},onMouseDown:E,onTouchStart:E,title:"Spin the wheel",children:b.jsx(v,{as:"canvas",ref:A,width:{base:"300px",md:"600px"},height:{base:"300px",md:"600px"},borderRadius:"full",boxShadow:"lg",opacity:a.length<2?.5:1,transition:"box-shadow 0.3s, transform 0.3s",_hover:{boxShadow:a.length<2?"lg":"xl",transform:a.length<2?"none":"scale(1.02)"}})})})};export{B as Wheel};
